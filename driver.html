<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AND-Suivi • Espace Livreur</title>

  <link rel="manifest" href="./manifest.webmanifest" />
  <meta name="theme-color" content="#0b1a24" />

  <link rel="icon" href="./icons/icon-192.png" />
  <link rel="apple-touch-icon" href="./apple-touch-icon.png" />

  <link rel="stylesheet" href="./style.css" />

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>

<body>
  <div class="app">
    <div class="topBar">
      <div class="brand">
        <img class="brandLogo" src="./assets/logo.png" alt="APERO de nuit" />
      </div>
      <div class="statusBadge" id="driverOnlineBadge">
        <span class="dot"></span>
        <span id="driverOnlineText">Livreur hors ligne</span>
      </div>
    </div>

    <div class="container">
      <h1 class="title">Espace Livreur</h1>

      <div class="kpiRow">
        <div class="kpiBox">
          <div class="kpiLabel">GPS livreur</div>
          <div class="kpiValue" id="gpsState">—</div>
        </div>

        <div class="kpiBox">
          <div class="kpiLabel">Dernière mise à jour</div>
          <div class="kpiValue" id="lastUpdate">—</div>
        </div>

        <div class="kpiBox">
          <div class="kpiLabel">Demandes</div>
          <div class="kpiValue" id="requestsCount">—</div>
        </div>

        <!-- ✅ AJOUT : Etat notifs push -->
        <div class="kpiBox">
          <div class="kpiLabel">Notifications</div>
          <div class="kpiValue" id="pushState">—</div>
        </div>
      </div>

      <div class="btnRow">
        <button class="btnPrimary" id="btnGpsStart">Activer GPS</button>
        <button class="btnDanger" id="btnGpsStop" disabled>Arrêter GPS</button>
      </div>

      <!-- ✅ AJOUT : bouton abonnement push -->
      <div class="btnRow">
        <button class="btnPrimary" id="btnPushEnable">Activer notifications</button>
      </div>

      <div class="btnRow">
        <button class="btnSecondary" id="btnCenter">Recentrer</button>
      </div>

      <div class="mapCard">
        <div id="map" class="map"></div>
      </div>

      <div class="section">
        <h2 class="sectionTitle">Demandes & suivis</h2>

        <div class="tipBox">
          Astuce : <b>+5</b> / <b>-5</b> ajuste le temps (max 30 min). <b>Stop</b> coupe immédiatement.
        </div>

        <div class="subTitle">En attente</div>
        <div id="pendingList" class="list"></div>

        <div class="subTitle">Actifs</div>
        <div id="activeList" class="list"></div>
      </div>

      <div class="footerDisclaimer">
        L'abus d'alcool est dangereux pour la santé, à consommer avec modération.
      </div>
    </div>
  </div>

  <!-- Leaflet -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <!-- App -->
  <script src="./config.js"></script>
  <script src="./shared.js"></script>
  <script src="./driver.js"></script>
</body>
</html>
